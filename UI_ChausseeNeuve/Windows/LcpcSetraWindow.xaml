<Window x:Class="UI_ChausseeNeuve.Windows.LcpcSetraWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:UI_ChausseeNeuve.ViewModels"
        Title="Beniroute - Guide Lcpc-Setra 1994"
        Height="650" Width="800"
        WindowStartupLocation="CenterOwner"
        Background="{StaticResource PrimaryBg}"
        ResizeMode="CanResize">

    <Window.DataContext>
        <vm:LcpcSetraViewModel />
    </Window.DataContext>

    <Window.Resources>
        <SolidColorBrush x:Key="PanelBg" Color="#3C4047"/>
        <SolidColorBrush x:Key="PanelCellBg" Color="#3F3F3F"/>
        <SolidColorBrush x:Key="PanelCellBorder" Color="#2E3237"/>

        <Style x:Key="HeaderCellBox" TargetType="Border">
            <Setter Property="BorderBrush" Value="{StaticResource PanelCellBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="{StaticResource PanelCellBg}"/>
            <Setter Property="Padding" Value="6,4"/>
            <Setter Property="CornerRadius" Value="4"/>
        </Style>
        <Style x:Key="CellBox" TargetType="Border" BasedOn="{StaticResource HeaderCellBox}">
            <Setter Property="Padding" Value="4,2"/>
        </Style>
    </Window.Resources>

    <Border Style="{StaticResource SectionCardStyle}" Margin="15">
        <DockPanel>
            <!-- Barre d'actions toujours visible en bas -->
            <StackPanel DockPanel.Dock="Bottom" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                <Button Content="OK" 
                        Style="{StaticResource PrimaryActionButtonStyle}" 
                        Click="OK_Click" 
                        Margin="0,0,10,0" 
                        MinWidth="80" />
                
                <Button Content="Annuler" 
                        Style="{StaticResource SecondaryActionButtonStyle}" 
                        Click="Cancel_Click" 
                        MinWidth="80" />
            </StackPanel>

            <!-- Padding a droite pour decoller la scrollbar du contenu -->
            <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="0,0,16,0">
                <StackPanel Margin="0,0,0,10">
                    
                    <TextBlock Text="Beniroute - CAM, valeurs du Guide Lcpc-Setra 1994" 
                               Style="{StaticResource SectionTitleStyle}" 
                               HorizontalAlignment="Center" 
                               Margin="0,0,0,20" />

                    <!-- Zone 1: Classification du Trafic -->
                    <Border Background="{StaticResource NormTablesBg}" BorderBrush="Transparent" BorderThickness="0" CornerRadius="8" Padding="15" Margin="0,0,0,15" TextElement.Foreground="#ECECEC">
                        <StackPanel>
                            <TextBlock Text="Classification du Trafic" FontWeight="Bold" FontSize="14" Foreground="White" Margin="0,0,0,10" />
                            <Grid HorizontalAlignment="Center">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80" />
                                    <ColumnDefinition Width="60" />
                                    <ColumnDefinition Width="60" />
                                    <ColumnDefinition Width="60" />
                                    <ColumnDefinition Width="60" />
                                    <ColumnDefinition Width="60" />
                                    <ColumnDefinition Width="60" />
                                    <ColumnDefinition Width="60" />
                                    <ColumnDefinition Width="60" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource HeaderCellBox}"><TextBlock Text="classes :"/></Border>
                                <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T5"/></Border>
                                <Border Grid.Row="0" Grid.Column="2" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T4"/></Border>
                                <Border Grid.Row="0" Grid.Column="3" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T3"/></Border>
                                <Border Grid.Row="0" Grid.Column="4" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T2"/></Border>
                                <Border Grid.Row="0" Grid.Column="5" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T1"/></Border>
                                <Border Grid.Row="0" Grid.Column="6" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T0"/></Border>
                                <Border Grid.Row="0" Grid.Column="7" Style="{StaticResource HeaderCellBox}"><TextBlock Text="TS"/></Border>
                                <Border Grid.Row="0" Grid.Column="8" Style="{StaticResource HeaderCellBox}"><TextBlock Text="TEX"/></Border>

                                <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource HeaderCellBox}"><TextBlock Text="moyenne MJA :"/></Border>
                                <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource CellBox}"><TextBlock Text="5"/></Border>
                                <Border Grid.Row="1" Grid.Column="2" Style="{StaticResource CellBox}"><TextBlock Text="35"/></Border>
                                <Border Grid.Row="1" Grid.Column="3" Style="{StaticResource CellBox}"><TextBlock Text="85"/></Border>
                                <Border Grid.Row="1" Grid.Column="4" Style="{StaticResource CellBox}"><TextBlock Text="200"/></Border>
                                <Border Grid.Row="1" Grid.Column="5" Style="{StaticResource CellBox}"><TextBlock Text="500"/></Border>
                                <Border Grid.Row="1" Grid.Column="6" Style="{StaticResource CellBox}"><TextBlock Text="1200"/></Border>
                                <Border Grid.Row="1" Grid.Column="7" Style="{StaticResource CellBox}"><TextBlock Text="3000"/></Border>
                                <Border Grid.Row="1" Grid.Column="8" Style="{StaticResource CellBox}"><TextBlock Text="9000"/></Border>

                                <Border Grid.Row="2" Grid.Column="0" Style="{StaticResource HeaderCellBox}"><TextBlock Text="limites MJA :"/></Border>
                                <Border Grid.Row="2" Grid.Column="1" Style="{StaticResource CellBox}"><TextBlock Text="0"/></Border>
                                <Border Grid.Row="2" Grid.Column="2" Style="{StaticResource CellBox}"><TextBlock Text="25"/></Border>
                                <Border Grid.Row="2" Grid.Column="3" Style="{StaticResource CellBox}"><TextBlock Text="50"/></Border>
                                <Border Grid.Row="2" Grid.Column="4" Style="{StaticResource CellBox}"><TextBlock Text="150"/></Border>
                                <Border Grid.Row="2" Grid.Column="5" Style="{StaticResource CellBox}"><TextBlock Text="300"/></Border>
                                <Border Grid.Row="2" Grid.Column="6" Style="{StaticResource CellBox}"><TextBlock Text="750"/></Border>
                                <Border Grid.Row="2" Grid.Column="7" Style="{StaticResource CellBox}"><TextBlock Text="2000"/></Border>
                                <Border Grid.Row="2" Grid.Column="8" Style="{StaticResource CellBox}"><TextBlock Text="5000"/></Border>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- Zone 2: CAM moyens et forts -->
                        <Border x:Name="CamBlockMoyensForts" Grid.Column="0" Background="{StaticResource NormTablesBg}" BorderBrush="Transparent" BorderThickness="0" CornerRadius="8" Padding="15" Margin="0,0,8,15" TextElement.Foreground="#ECECEC">
                            <StackPanel>
                                <TextBlock Text="CAM, trafics moyens et forts" FontWeight="Bold" FontSize="12" Foreground="White" Margin="0,0,0,10" />
                                <Grid HorizontalAlignment="Center">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="80" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource HeaderCellBox}"><TextBlock Text="Materiaux :"/></Border>
                                    <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource HeaderCellBox}"><TextBlock Text="cam :"/></Border>

                                    <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource CellBox}"><TextBlock Text="- bitumineux h&gt;20cm (*) :"/></Border>
                                    <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource CellBox}"><Button Content="{Binding CamBitumineux, StringFormat='{}{0:F1}'}" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectCamCommand}" CommandParameter="bitumineux" HorizontalAlignment="Center" Width="60" Padding="5,3" FontSize="11"/></Border>

                                    <Border Grid.Row="2" Grid.Column="0" Style="{StaticResource CellBox}"><TextBlock Text="- bitumineux h&lt;20cm (*) :"/></Border>
                                    <Border Grid.Row="2" Grid.Column="1" Style="{StaticResource CellBox}"><Button Content="{Binding CamBitumineuxMince, StringFormat='{}{0:F1}'}" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectCamCommand}" CommandParameter="bitumineux_mince" HorizontalAlignment="Center" Width="60" Padding="5,3" FontSize="11"/></Border>

                                    <Border Grid.Row="3" Grid.Column="0" Style="{StaticResource CellBox}"><TextBlock Text="- bitumineux, structures"/></Border>
                                    <Border Grid.Row="3" Grid.Column="1" Style="{StaticResource CellBox}"><Button Content="{Binding CamBitumineuxStructures, StringFormat='{}{0:F1}'}" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectCamCommand}" CommandParameter="bitumineux_structures" HorizontalAlignment="Center" Width="60" Padding="5,3" FontSize="11"/></Border>

                                    <Border Grid.Row="4" Grid.Column="0" Style="{StaticResource CellBox}"><TextBlock Text="- traites liants hydrauliques :"/></Border>
                                    <Border Grid.Row="4" Grid.Column="1" Style="{StaticResource CellBox}"><Button Content="{Binding CamTraitesHydrauliques, StringFormat='{}{0:F1}'}" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectCamCommand}" CommandParameter="traites_hydrauliques" HorizontalAlignment="Center" Width="60" Padding="5,3" FontSize="11"/></Border>

                                    <Border Grid.Row="5" Grid.Column="0" Style="{StaticResource CellBox}"><TextBlock Text="- beton :"/></Border>
                                    <Border Grid.Row="5" Grid.Column="1" Style="{StaticResource CellBox}"><Button Content="{Binding CamBeton, StringFormat='{}{0:F1}'}" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectCamCommand}" CommandParameter="beton" HorizontalAlignment="Center" Width="60" Padding="5,3" FontSize="11"/></Border>

                                    <Border Grid.Row="6" Grid.Column="0" Style="{StaticResource CellBox}"><TextBlock Text="- granulaires (sol, gnt) :"/></Border>
                                    <Border Grid.Row="6" Grid.Column="1" Style="{StaticResource CellBox}"><Button Content="{Binding CamGranulaires, StringFormat='{}{0:F1}'}" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectCamCommand}" CommandParameter="granulaires" HorizontalAlignment="Center" Width="60" Padding="5,3" FontSize="11"/></Border>
                                </Grid>

                                <TextBlock Text="(*) : sauf structures mixtes et inverses" FontSize="10" Margin="0,10,0,0" />
                            </StackPanel>
                        </Border>

                        <!-- Zone 3: CAM faibles trafics -->
                        <Border x:Name="CamBlockFaibles" Grid.Column="1" Background="{StaticResource NormTablesBg}" BorderBrush="Transparent" BorderThickness="0" CornerRadius="8" Padding="15" Margin="8,0,0,15" TextElement.Foreground="#ECECEC">
                            <StackPanel>
                                <TextBlock Text="CAM, faibles trafics" FontWeight="Bold" FontSize="12" Foreground="White" Margin="0,0,0,10" />
                                <Grid HorizontalAlignment="Center">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="60" />
                                        <ColumnDefinition Width="60" />
                                        <ColumnDefinition Width="60" />
                                        <ColumnDefinition Width="60" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource HeaderCellBox}"><TextBlock Text="Tous materiaux :"/></Border>
                                    <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T5"/></Border>
                                    <Border Grid.Row="0" Grid.Column="2" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T4"/></Border>
                                    <Border Grid.Row="0" Grid.Column="3" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T3"/></Border>
                                    <Border Grid.Row="0" Grid.Column="4" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T3+"/></Border>

                                    <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource CellBox}"><Button Content="{Binding CamT5, StringFormat='{}{0:F1}'}" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectCamCommand}" CommandParameter="T5" HorizontalAlignment="Center" Width="50" Padding="5,3" FontSize="11"/></Border>
                                    <Border Grid.Row="1" Grid.Column="2" Style="{StaticResource CellBox}"><Button Content="{Binding CamT4, StringFormat='{}{0:F1}'}" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectCamCommand}" CommandParameter="T4" HorizontalAlignment="Center" Width="50" Padding="5,3" FontSize="11"/></Border>
                                    <Border Grid.Row="1" Grid.Column="3" Style="{StaticResource CellBox}"><Button Content="{Binding CamT3, StringFormat='{}{0:F1}'}" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectCamCommand}" CommandParameter="T3" HorizontalAlignment="Center" Width="50" Padding="5,3" FontSize="11"/></Border>
                                    <Border Grid.Row="1" Grid.Column="4" Style="{StaticResource CellBox}"><Button Content="{Binding CamT3Plus, StringFormat='{}{0:F1}'}" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectCamCommand}" CommandParameter="T3+" HorizontalAlignment="Center" Width="50" Padding="5,3" FontSize="11"/></Border>

                                    <Border Grid.Row="2" Grid.ColumnSpan="5" Background="#22FFFFFF" BorderBrush="#66FFFFFF" BorderThickness="1" CornerRadius="4" Padding="8" Margin="0,10,0,0">
                                        <TextBlock Text="Cliquer sur une valeur CAM pour l'appliquer aux couches correspondantes dans le tableau des valeurs admissibles" 
                                                 FontSize="10" 
                                                 TextWrapping="Wrap" 
                                                 Foreground="White" />
                                    </Border>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- Zone 4: Valeurs du risque en % (nouvelle) -->
                    <Border x:Name="RiskBlock" Background="{StaticResource NormTablesBg}" BorderBrush="Transparent" BorderThickness="0" CornerRadius="8" Padding="15" Margin="0,0,0,15" TextElement.Foreground="#ECECEC">
                        <StackPanel>
                            <TextBlock Text="Valeurs du risque en %" FontWeight="Bold" FontSize="12" Foreground="White" Margin="0,0,0,10" />
                            <Grid HorizontalAlignment="Center">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="160"/>
                                    <ColumnDefinition Width="160"/>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="80"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Entetes -->
                                <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource HeaderCellBox}"><TextBlock Text="Structures :"/></Border>
                                <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource HeaderCellBox}"><TextBlock Text="Materiaux :"/></Border>
                                <Border Grid.Row="0" Grid.Column="2" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T3"/></Border>
                                <Border Grid.Row="0" Grid.Column="3" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T2"/></Border>
                                <Border Grid.Row="0" Grid.Column="4" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T1"/></Border>
                                <Border Grid.Row="0" Grid.Column="5" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T0"/></Border>

                                <!-- usuelles: fusion sur 2 lignes -->
                                <Border Grid.Row="1" Grid.Column="0" Grid.RowSpan="2" Style="{StaticResource CellBox}"><TextBlock Text="- usuelles" VerticalAlignment="Center"/></Border>
                                <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource CellBox}"><TextBlock Text="bitumineux"/></Border>
                                <Border Grid.Row="1" Grid.Column="2" Style="{StaticResource CellBox}"><Button Content="25%" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectRiskCommand}" CommandParameter="25|R usuelles bitumineux"/></Border>
                                <Border Grid.Row="1" Grid.Column="3" Style="{StaticResource CellBox}"><Button Content="12%" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectRiskCommand}" CommandParameter="12|R usuelles bitumineux"/></Border>
                                <Border Grid.Row="1" Grid.Column="4" Style="{StaticResource CellBox}"><Button Content="5%" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectRiskCommand}" CommandParameter="5|R usuelles bitumineux"/></Border>
                                <Border Grid.Row="1" Grid.Column="5" Style="{StaticResource CellBox}"><Button Content="2%" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectRiskCommand}" CommandParameter="2|R usuelles bitumineux"/></Border>

                                <Border Grid.Row="2" Grid.Column="1" Style="{StaticResource CellBox}"><TextBlock Text="traites liants hydr."/></Border>
                                <Border Grid.Row="2" Grid.Column="2" Style="{StaticResource CellBox}"><Button Content="12%" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectRiskCommand}" CommandParameter="12|R usuelles MTLH"/></Border>
                                <Border Grid.Row="2" Grid.Column="3" Style="{StaticResource CellBox}"><Button Content="7,5%" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectRiskCommand}" CommandParameter="7.5|R usuelles MTLH"/></Border>
                                <Border Grid.Row="2" Grid.Column="4" Style="{StaticResource CellBox}"><Button Content="5%" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectRiskCommand}" CommandParameter="5|R usuelles MTLH"/></Border>
                                <Border Grid.Row="2" Grid.Column="5" Style="{StaticResource CellBox}"><Button Content="2,5%" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectRiskCommand}" CommandParameter="2.5|R usuelles MTLH"/></Border>

                                <!-- inverses: fusion sur 2 lignes -->
                                <Border Grid.Row="3" Grid.Column="0" Grid.RowSpan="2" Style="{StaticResource CellBox}"><TextBlock Text="- inverses" VerticalAlignment="Center"/></Border>
                                <Border Grid.Row="3" Grid.Column="1" Style="{StaticResource CellBox}"><TextBlock Text="bitumineux"/></Border>
                                <Border Grid.Row="3" Grid.Column="2" Style="{StaticResource CellBox}"><Button Content="25%" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectRiskCommand}" CommandParameter="25|R inverses bitumineux"/></Border>
                                <Border Grid.Row="3" Grid.Column="3" Style="{StaticResource CellBox}"><Button Content="12%" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectRiskCommand}" CommandParameter="12|R inverses bitumineux"/></Border>
                                <Border Grid.Row="3" Grid.Column="4" Style="{StaticResource CellBox}"><Button Content="5%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="5|R inverses bitumineux" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="3" Grid.Column="5" Style="{StaticResource CellBox}"><Button Content="2%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="2|R inverses bitumineux" Command="{Binding SelectRiskCommand}"/></Border>

                                <Border Grid.Row="4" Grid.Column="1" Style="{StaticResource CellBox}"><TextBlock Text="traites liants hydr."/></Border>
                                <Border Grid.Row="4" Grid.Column="2" Style="{StaticResource CellBox}"><Button Content="24%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="24|R inverses MTLH" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="4" Grid.Column="3" Style="{StaticResource CellBox}"><Button Content="15%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="15|R inverses MTLH" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="4" Grid.Column="4" Style="{StaticResource CellBox}"><Button Content="10%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="10|R inverses MTLH" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="4" Grid.Column="5" Style="{StaticResource CellBox}"><Button Content="5%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="5|R inverses MTLH" Command="{Binding SelectRiskCommand}"/></Border>

                                <!-- mixtes: fusion sur 2 lignes -->
                                <Border Grid.Row="5" Grid.Column="0" Grid.RowSpan="2" Style="{StaticResource CellBox}"><TextBlock Text="- mixtes" VerticalAlignment="Center"/></Border>
                                <Border Grid.Row="5" Grid.Column="1" Style="{StaticResource CellBox}"><TextBlock Text="bitumineux"/></Border>
                                <Border Grid.Row="5" Grid.Column="2" Style="{StaticResource CellBox}"><Button Content="25%" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectRiskCommand}" CommandParameter="25|R mixtes bitumineux"/></Border>
                                <Border Grid.Row="5" Grid.Column="3" Style="{StaticResource CellBox}"><Button Content="12%" Style="{StaticResource SecondaryActionButtonStyle}" Command="{Binding SelectRiskCommand}" CommandParameter="12|R mixtes bitumineux"/></Border>
                                <Border Grid.Row="5" Grid.Column="4" Style="{StaticResource CellBox}"><Button Content="5%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="5|R mixtes bitumineux" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="5" Grid.Column="5" Style="{StaticResource CellBox}"><Button Content="2%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="2|R mixtes bitumineux" Command="{Binding SelectRiskCommand}"/></Border>

                                <Border Grid.Row="6" Grid.Column="1" Style="{StaticResource CellBox}"><TextBlock Text="traites liants hydr."/></Border>
                                <Border Grid.Row="6" Grid.Column="2" Style="{StaticResource CellBox}"><Button Content="35%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="35|R mixtes MTLH" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="6" Grid.Column="3" Style="{StaticResource CellBox}"><Button Content="20%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="20|R mixtes MTLH" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="6" Grid.Column="4" Style="{StaticResource CellBox}"><Button Content="10%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="10|R mixtes MTLH" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="6" Grid.Column="5" Style="{StaticResource CellBox}"><Button Content="5%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="5|R mixtes MTLH" Command="{Binding SelectRiskCommand}"/></Border>
                            </Grid>

                            <!-- Beton bloc -->
                            <Grid HorizontalAlignment="Center" Margin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="160"/>
                                    <ColumnDefinition Width="160"/>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="80"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- En-tetes uniquement pour T3..T0 -->
                                <Border Grid.Row="0" Grid.Column="2" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T3"/></Border>
                                <Border Grid.Row="0" Grid.Column="3" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T2"/></Border>
                                <Border Grid.Row="0" Grid.Column="4" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T1"/></Border>
                                <Border Grid.Row="0" Grid.Column="5" Style="{StaticResource HeaderCellBox}"><TextBlock Text="T0"/></Border>

                                <!-- Libelle groupe: - en beton (fusion 3 lignes) -->
                                <Border Grid.Row="1" Grid.Column="0" Grid.RowSpan="3" Style="{StaticResource CellBox}"><TextBlock Text="- en beton" VerticalAlignment="Center"/></Border>

                                <!-- Ligne 1: couche de base -->
                                <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource CellBox}"><TextBlock Text="couche de base"/></Border>
                                <Border Grid.Row="1" Grid.Column="2" Style="{StaticResource CellBox}"><Button Content="11,5%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="11.5|R beton base" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="1" Grid.Column="3" Style="{StaticResource CellBox}"><Button Content="7,5%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="7.5|R beton base" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="1" Grid.Column="4" Style="{StaticResource CellBox}"><Button Content="5%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="5|R beton base" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="1" Grid.Column="5" Style="{StaticResource CellBox}"><Button Content="2,8%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="2.8|R beton base" Command="{Binding SelectRiskCommand}"/></Border>

                                <!-- Ligne 2: c.fond. sauf Bac/BCg -->
                                <Border Grid.Row="2" Grid.Column="1" Style="{StaticResource CellBox}"><TextBlock Text="c.fond. sauf Bac/BCg"/></Border>
                                <Border Grid.Row="2" Grid.Column="2" Style="{StaticResource CellBox}"><Button Content="23%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="23|R beton fondation" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="2" Grid.Column="3" Style="{StaticResource CellBox}"><Button Content="15%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="15|R beton fondation" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="2" Grid.Column="4" Style="{StaticResource CellBox}"><Button Content="10%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="10|R beton fondation" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="2" Grid.Column="5" Style="{StaticResource CellBox}"><Button Content="5,6%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="5.6|R beton fondation" Command="{Binding SelectRiskCommand}"/></Border>

                                <!-- Ligne 3: c.fond. pour Bac/BCg -->
                                <Border Grid.Row="3" Grid.Column="1" Style="{StaticResource CellBox}"><TextBlock Text="c.fond. pour Bac/BCg"/></Border>
                                <Border Grid.Row="3" Grid.Column="2" Style="{StaticResource CellBox}"><Button Content="40%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="40|R beton fondation BacBCg" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="3" Grid.Column="3" Style="{StaticResource CellBox}"><Button Content="50%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="50|R beton fondation BacBCg" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="3" Grid.Column="4" Style="{StaticResource CellBox}"><Button Content="50%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="50|R beton fondation BacBCg" Command="{Binding SelectRiskCommand}"/></Border>
                                <Border Grid.Row="3" Grid.Column="5" Style="{StaticResource CellBox}"><Button Content="50%" Style="{StaticResource SecondaryActionButtonStyle}" CommandParameter="50|R beton fondation BacBCg" Command="{Binding SelectRiskCommand}"/></Border>
                            </Grid>

                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </DockPanel>
    </Border>
</Window>